{
  "app-id": "org.ioquake.ioq3",
  "runtime": "org.freedesktop.Platform",
  "runtime-version": "25.08",
  "sdk": "org.freedesktop.Sdk",
  "rename-desktop-file": "quake3.desktop",
  "rename-icon": "quake3",
  "rename-appdata-file": "quake3.appdata.xml",
  "finish-args": [
    "--device=dri",
    "--share=ipc",
    "--share=network",
    "--socket=fallback-x11",
    "--socket=wayland",
    "--socket=pulseaudio",
    "--persist=.q3a"
  ],
  "command": "quake3",
  "modules": [
    {
      "name": "ioquake3",
      "buildsystem": "cmake",
      "config-opts": [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DCMAKE_INSTALL_PREFIX=/app/bin"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/ioquake/ioq3.git",
          "branch": "main"
        }
      ],
      "post-install": [
        "install -Dm644 misc/quake3.svg /app/share/icons/hicolor/scalable/apps/quake3.svg"
      ]
    },
    {
      "name": "ioquake3-data",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p /app/share/applications",
        "mkdir -p /app/share/appdata",
        "install -Dm644 quake3.desktop /app/share/applications/",
        "install -Dm644 quake3.appdata.xml /app/share/appdata/",
        "sh linuxq3apoint-1.32b-3.x86.run --tar xf",
        "mkdir -p /app/bin/{baseq3,missionpack,demoq3}",
        "install -m 644 baseq3/*.pk3 /app/bin/baseq3/",
        "install -m 644 missionpack/*.pk3 /app/bin/missionpack/",
        "ln -sf /app/baseq3/pak{1..8}.pk3 /app/bin/demoq3/",
        "install -Dm644 pak0.pk3 /app/bin/baseq3/",
        "install -Dm777 quake3.sh /app/bin/quake3"
      ],
      "sources": [
        {
          "type": "file",
          "url": "http://ftp.gwdg.de/pub/misc/ftp.idsoftware.com/idstuff/quake3/linux/linuxq3apoint-1.32b-3.x86.run",
          "sha256": "c36132c5556b35e01950f1e9c646235033a5130f87ad776ba2bc7becf4f4f186"
        },
        {
          "type": "file",
          "path": "quake3.desktop"
        },
        {
          "type": "file",
          "path": "quake3.appdata.xml"
        },
        {
          "type": "file",
          "path": "pak0.pk3"
        },
        {
          "type": "file",
          "path": "quake3.sh"
        }
      ]
}
  ]
}
